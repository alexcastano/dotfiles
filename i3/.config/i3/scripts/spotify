#!/bin/bash

# Handle click events
case $BLOCK_BUTTON in
    1) ~/.config/i3/scripts/player.py play-pause > /dev/null 2>&1 && pkill -RTMIN+11 i3blocks ;; # left click - play/pause
    3) ~/.config/i3/scripts/player.py next > /dev/null 2>&1 && pkill -RTMIN+11 i3blocks ;;        # right click - next track
    2) ~/.config/i3/scripts/player.py previous > /dev/null 2>&1 && pkill -RTMIN+11 i3blocks ;;    # middle click - previous track
esac

# Display current status - only show icon, artist and title (no album/disc)
output=$(timeout 3 ~/.config/i3/scripts/player.py status -f '{icon} {artist} - {title}' \
    --icon-playing '󰐊' \
    --icon-paused '󰏤' \
    --icon-stopped '󰝤' \
    --icon-none '' 2>/dev/null)

# Escape special characters for pango markup
output=$(echo "$output" | sed 's/&/\&amp;/g; s/</\&lt;/g; s/>/\&gt;/g')

# Only display if there's actual content (not empty or just stopped icon)
if [ -n "$output" ] && [ "$output" != "󰝤" ]; then
    echo "$output"
fi
